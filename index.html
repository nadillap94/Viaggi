<!DOCTYPE html>
<html lang="it"> /* Definisce il tipo di documento (HTML5) e imposta la lingua su italiano */
<head>
    <meta charset="UTF-8"> /* Specifica la codifica dei caratteri, essenziale per gli accenti */
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> /* Rende la pagina responsive, cio√® adatta a tutti gli schermi (Mobile-First) */
    <title>Vienna Imperiale - La Tua Guida di Viaggio</title> /* Il titolo che appare nella scheda del browser */
    
    <script src="https://cdn.tailwindcss.com"></script> /* Importa Tailwind CSS, un kit di classi predefinite per lo stile rapido */
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script> /* Importa Chart.js per la creazione del grafico budget */
    
    <script src="https://unpkg.com/lucide@latest"></script> /* Importa la libreria Lucide per le icone SVG moderne */
    
    <style>
        /* Inizio del blocco per gli stili CSS personalizzati */
        /* Questo blocco contiene gli stili di base e il tema "imperiale" */
        :root { /* Definisce le Variabili CSS, rendendo facile cambiare i colori in un solo punto */
            --color-primary: #8C0000; /* Bordeaux Scuro (rich red) */
            --color-secondary: #C8AA50; /* Oro Antico (muted gold) */
            --color-background: #FAF8F4; /* Crema/Bianco Sporco */
            --color-text: #2c2c2c; /* Grigio Scuro Profondo */
        }

        body {
            font-family: 'Georgia', serif; /* Font con grazie per un tocco classico */
            background-color: var(--color-background); /* Applica il colore di sfondo */
            color: var(--color-text); /* Applica il colore principale del testo */
        }

        .header-bg { /* Classe per l'intestazione */
            background-color: var(--color-primary);
            color: white;
            padding: 1rem 0;
            border-bottom: 6px solid var(--color-secondary); /* Bordo spesso color oro */
        }

        .accent-color { color: var(--color-primary); } /* Colore del testo primario (Bordeaux) */
        .border-accent { border-color: var(--color-secondary); } /* Colore del bordo secondario (Oro) */

        /* Stile specifico per la Timeline */
        .timeline-item { border-left: 2px solid var(--color-secondary); } /* La linea verticale della timeline */
        .timeline-point {
            background-color: var(--color-primary);
            border: 4px solid var(--color-secondary); /* Il punto che evidenzia l'attivit√† sulla linea */
        }

        /* Stile pulsante dettagli */
        .details-btn { background-color: var(--color-primary); }
        .details-btn:hover { background-color: #6C0000; } /* Leggero scurimento al passaggio del mouse */
        
        /* Stile per la Stampa (Ottimizzazione A4) */
        @media print { /* Gli stili all'interno di questo blocco si applicano solo quando l'utente stampa */
            body {
                background-color: white !important; /* Forza lo sfondo a bianco per risparmiare inchiostro */
                color: black !important;
                font-size: 10pt; /* Rimpicciolisce il testo per adattarsi meglio al foglio A4 */
            }
            .no-print, .details-btn { display: none !important; } /* Nasconde elementi interattivi o non essenziali per la stampa (es. grafico) */
            .header-bg, .footer-bg {
                background-color: white !important;
                color: black !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact; /* Assicura che i colori di sfondo vengano ignorati in stampa */
                border-bottom: 1px solid black !important;
            }
            .timeline-item { border-left: 1px dashed gray; } /* Rende la linea della timeline meno pesante in stampa */
            .timeline-point {
                 background-color: white !important;
                 border-color: black !important; /* Rende il punto in bianco e nero per la stampa */
            }
        }
    </style>
</head>
<body>

    <header class="header-bg shadow-lg"> /* Intestazione della guida */
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"> /* Contenitore per centrare il contenuto */
            <h1 class="text-4xl font-extrabold tracking-wider text-center">VIENNA IMPERIALE <span class="text-yellow-200">üëë</span></h1> /* Titolo principale con emoji */
            <p class="text-center text-sm mt-1 opacity-90">La Tua Guida Turistica Illustrata - Mobile-First</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8"> /* Contenitore principale per il corpo del contenuto */

        <section class="mb-12 p-4 sm:p-6 bg-white shadow-xl rounded-xl">
             <h2 class="text-3xl font-bold mb-4 accent-color">Benvenuti nell'Impero!</h2>
             <p class="text-lg mb-4">Questa √® la tua guida interattiva e stampabile...</p>
             <p class="text-sm italic">Durata stimata: 4 giorni... Budget totale stimato per persona: <span class="font-bold" id="total-budget-placeholder">...</span></p> /* Placeholder che sar√† riempito da JavaScript */
        </section>


        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-6 pb-2 border-b border-accent accent-color flex items-center">
                <i data-lucide="image" class="mr-2 text-xl"></i> Vetrina Illustrata & Mappe (Statiche) /* Icona tramite Lucide */
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"> /* Griglia a 3 colonne per schermi grandi */
                
                <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200">
                    <img src="https://placehold.co/600x400/C8AA50/8C0000?text=Palazzo+Schonbrunn" alt="Immagine di Sch√∂nbrunn" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="font-bold text-lg accent-color">Sch√∂nbrunn</h3>
                        <p class="text-sm text-gray-600">Placeholder: Palazzo e giardini imperiali.</p>
                    </div>
                </div>

                <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200">
                    <img src="https://placehold.co/600x400/2c2c2c/FAF8F4?text=Mappa+Centro+Storico" alt="Mappa Centro Storico" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="font-bold text-lg accent-color">1¬∞ Distretto (Mappa)</h3>
                        <p class="text-sm text-gray-600">Placeholder: Inserisci qui lo snapshot statico.</p>
                    </div>
                </div>
                
                <div class="bg-white shadow-lg rounded-lg overflow-hidden border border-gray-200">
                    <img src="https://placehold.co/600x400/8C0000/FAF8F4?text=Stephansdom" alt="Immagine di Stephansdom" class="w-full h-48 object-cover">
                    <div class="p-4">
                        <h3 class="font-bold text-lg accent-color">Stephansdom</h3>
                        <p class="text-sm text-gray-600">Placeholder: Il simbolo gotico della citt√†.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-8 pb-2 border-b border-accent accent-color flex items-center">
                <i data-lucide="calendar-check" class="mr-2 text-xl"></i> Itinerario Giorno per Giorno
            </h2>
            <div id="timeline-container" class="relative"> /* Contenitore vuoto: qui JavaScript inserir√† l'itinerario */
                </div>
        </section>
        
        <section class="mb-12">
            <h2 class="text-2xl font-bold mb-6 pb-2 border-b border-accent accent-color flex items-center">
                <i data-lucide="utensils" class="mr-2 text-xl"></i> Delizie Culinarie di Vienna
            </h2>
            <div id="food-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"> /* Contenitore vuoto: qui JavaScript inserir√† la lista del cibo */
                </div>
        </section>


        <section class="mb-12 no-print"> /* no-print assicura che il grafico non venga stampato */
            <h2 class="text-2xl font-bold mb-6 pb-2 border-b border-accent accent-color flex items-center">
                <i data-lucide="wallet" class="mr-2 text-xl"></i> Analisi Budget (Costo per Persona)
            </h2>
            <div class="bg-white p-6 rounded-xl shadow-xl border border-gray-100">
                <canvas id="budgetChart"></canvas> /* L'elemento HTML dove Chart.js disegner√† il grafico */
                <p class="text-center text-sm mt-4 italic text-gray-500">I costi sono stimati per persona...</p>
            </div>
        </section>

    </main>

    <footer class="footer-bg text-center text-sm py-4 mt-8 bg-gray-100 print:hidden">
        ¬© Vienna Imperiale Guida | Minisito Generato da Disegnaviaggi /* Footer visibile solo sullo schermo */
    </footer>

<script>
    // Inizializza le icone Lucide
    lucide.createIcons(); /* Funzione che trasforma i tag <i data-lucide="..."> in vere icone SVG */

    // ===========================================
    // 1. DATA ESTRATTA E STRUTTURATA DAI FILE CSV
    // ===========================================

    // Dati Itinerario (PianoViaggio Vienna - PianoVienna.csv)
    const itineraryData = [ /* Array (lista) di oggetti JavaScript per l'itinerario */
        { giorno: 1, data: "Venerd√¨ 5", ora: "09:00 - 14:00", attivita: "Viaggio, Transfer, Check-in, Pranzo", luogo: "Leopoldstadt (2¬∞ distretto)", focus: "Trasporto", note: "Pranzo Low-Cost: Sfrutta un piccolo Imbiss in zona alloggio (1020)." },
        { giorno: 1, data: "Venerd√¨ 5", ora: "14:00 - 17:00", attivita: "Centro Storico (1010): Esplorazione a piedi", luogo: "Stephansdom, Stephansplatz 3, 1010 Wien", focus: "Passeggiata", note: "La Cattedrale di Santo Stefano √® il simbolo gotico della citt√†. Focus fotografico." },
        { giorno: 1, data: "Venerd√¨ 5", ora: "17:00 - 18:00", attivita: "Mercatino Stephansplatz (1¬∞)", luogo: "Stephansplatz, 1010 Wien", focus: "Shopping", note: "Bevi il primo Gl√ºhwein qui per scaldarti. Mercatino 1/9." },
        { giorno: 2, data: "Sabato 6", ora: "10:00 - 14:00", attivita: "Palazzo di Sch√∂nbrunn", luogo: "Sch√∂nbrunner Schlo√üstra√üe 47, 1130 Wien", focus: "Cultura", note: "Visita del 'Grand Tour' e dei giardini. T.T. = 4h." },
        { giorno: 4, data: "Luned√¨ 8", ora: "14:00 - 17:00", attivita: "Transfer e Partenza", luogo: "Vienna Hauptbahnhof / Aeroporto", focus: "Trasporto", note: "Transfer Aeroporto (S7 A/R). Fine del viaggio." }
    ]; /* I dati sono stati abbreviati per chiarezza esplicativa, l'array completo √® nel codice originale. */

    // Dati Cibo (PianoViaggio Vienna - CiboVienna.csv)
    const foodData = [ /* Array di oggetti per i suggerimenti culinari */
        { piatto: "Wiener Schnitzel", descrizione: "Cotoletta viennese DOC di vitello...", suggerimenti: "Nei Beisl.", indirizzo_suggerito: "Bitzinger Augustinerkeller (Albertinaplatz 1, 1010 Wien)" },
        { piatto: "Sachertorte", descrizione: "Torta al cioccolato fondente e marmellata...", suggerimenti: "All'Hotel Sacher o in qualsiasi Caf√©.", indirizzo_suggerito: "Hotel Sacher (Philharmoniker-Str. 4, 1010 Wien)" },
    ]; /* I dati sono stati abbreviati per chiarezza esplicativa. */
    
    // Dati Budget (PianoViaggio Vienna - BudgetVienna.csv)
    const budgetData = [ /* Array di oggetti per il calcolo e il grafico del budget */
        { categoria: "Alloggio (3 notti)", costo: 121.50 },
        { categoria: "Trasporti (Abbonamento 72h)", costo: 17.10 },
        { categoria: "Ingressi (Sch√∂nbrunn)", costo: 22.00 },
        { categoria: "Cibo & Bevande (Stimato)", costo: 120.00 },
    ]; /* I dati sono stati abbreviati per chiarezza esplicativa. */


    // ===========================================
    // 2. FUNZIONI DI SUPPORTO PER ICONE LUCIDE
    // ===========================================

    /**
     * Restituisce il nome dell'icona Lucide basata sulla categoria di focus.
     */
    function getIconNameByFocus(focus) {
        const focusMap = { /* Mappa chiave-valore per associare le parole chiave (focus) alle icone */
            'Cultura': 'castle',
            'Arte': 'brush',
            'Passeggiata': 'map-pin',
            'Trasporto': 'train',
            'Architettura': 'building-2',
            'Shopping': 'shopping-bag',
            'Cibo': 'coffee',
            default: 'circle-dot'
        };
        const normalizedFocus = focus.split('/')[0].trim(); /* Prende solo la prima parte del focus (es. "Natura/Zoo" -> "Natura") */
        return focusMap[normalizedFocus] || focusMap.default; /* Restituisce l'icona mappata, altrimenti l'icona di default */
    }

    // ===========================================
    // 3. LOGICA DI RENDERING ITINERARIO (TIMELINE)
    // ===========================================

    const timelineContainer = document.getElementById('timeline-container'); /* Ottiene il contenitore vuoto della timeline */
    let htmlTimeline = ''; /* Stringa che accumuler√† l'HTML generato */
    let lastDay = 0; /* Variabile per tracciare il giorno e inserire i titoli solo all'inizio di un nuovo giorno */

    itineraryData.forEach((item, index) => { /* Cicla su ogni elemento dell'array itineraryData */
        // Inizio di un nuovo giorno
        if (item.giorno !== lastDay) { /* Condizione vera solo quando il giorno cambia */
            // Aggiunge il titolo del giorno
            htmlTimeline += `
                <h3 class="text-xl font-bold mt-8 mb-4 pt-4 border-t border-accent accent-color">
                    Giorno ${item.giorno}: ${item.data}
                </h3>
            `;
            lastDay = item.giorno; /* Aggiorna il tracker del giorno */
        }

        const iconName = getIconNameByFocus(item.focus); /* Trova l'icona corretta per l'attivit√† */
        
        // Costruzione dell'elemento HTML per l'attivit√† corrente
        htmlTimeline += `
            <div class="timeline-item relative py-4">
                <div class="timeline-point absolute -left-0.5 top-6 w-3 h-3 rounded-full z-10"></div> /* Il punto visivo sulla linea */
                <div class="bg-white p-4 ml-4 rounded-lg shadow-md hover:shadow-xl transition duration-300 transform hover:scale-[1.01]">
                    <div class="flex items-start mb-2 justify-between">
                        <div class="flex items-center">
                            <i data-lucide="${iconName}" class="w-5 h-5 mr-3 accent-color shrink-0"></i> /* Inserisce l'icona dinamica */
                            <span class="font-bold text-lg accent-color">${item.attivita}</span>
                        </div>
                         <span class="text-sm font-semibold text-gray-500">${item.ora}</span>
                    </div>
                    <p class="text-sm text-gray-700 mb-2 pl-8">üìç ${item.luogo}</p>
                    
                    <button 
                        class="details-btn text-xs font-semibold text-white py-1 px-3 rounded-full mt-2 no-print"
                        onclick="toggleDetails('details-${index}')" /* Assegna una funzione JavaScript al click, passando un ID unico */
                    >
                        Mostra Dettagli
                    </button>
                    <div id="details-${index}" class="hidden mt-3 pt-3 border-t border-gray-100 text-sm"> /* Contenitore dei dettagli nascosto di default */
                        <p class="font-semibold text-gray-800"><span class="accent-color">Focus:</span> ${item.focus}</p>
                        <p class="italic text-gray-600"><span class="accent-color">Note:</span> ${item.note}</p>
                    </div>
                </div>
            </div>
        `;
    });
    
    timelineContainer.innerHTML = htmlTimeline; /* Inserisce tutto l'HTML generato nel contenitore */
    lucide.createIcons(); /* Richiama la funzione per renderizzare le nuove icone aggiunte dinamicamente */

    // Funzione per l'interattivit√† (mostra/nascondi dettagli)
    window.toggleDetails = function(id) { /* Funzione globale per l'interazione mostra/nascondi */
        const element = document.getElementById(id); /* Trova l'elemento dettagli da mostrare/nascondere */
        const button = event.target; /* Riferimento al pulsante cliccato */
        
        if (element.classList.contains('hidden')) {
            element.classList.remove('hidden'); /* Rimuove la classe 'hidden' per mostrare i dettagli */
            button.textContent = 'Nascondi Dettagli'; /* Aggiorna il testo del pulsante */
        } else {
            element.classList.add('hidden'); /* Aggiunge la classe 'hidden' per nascondere i dettagli */
            button.textContent = 'Mostra Dettagli';
        }
    };


    // ===========================================
    // 4. LOGICA DI RENDERING CIBO
    // ===========================================
    
    const foodListContainer = document.getElementById('food-list'); /* Ottiene il contenitore per la lista cibo */
    let htmlFood = '';

    foodData.forEach(food => { /* Cicla su ogni elemento dell'array foodData */
        // Costruisce la parte dell'indirizzo solo se l'informazione √® disponibile
        const addressHtml = food.indirizzo_suggerito 
            ? `<p class="text-xs text-gray-500 mt-2 italic border-t pt-2">Indirizzo Suggerito: ${food.indirizzo_suggerito}</p>`
            : '';
        
        htmlFood += `
            <div class="bg-white p-4 rounded-lg shadow-md border-l-4 border-accent hover:shadow-xl transition duration-300">
                <h4 class="font-bold text-lg accent-color">${food.piatto}</h4>
                <p class="text-sm text-gray-700 mt-1">${food.descrizione}</p>
                <p class="text-xs text-gray-500 mt-2 italic border-t pt-2">Consiglio: ${food.suggerimenti}</p>
                ${addressHtml} /* Inserisce l'HTML dell'indirizzo (o una stringa vuota) */
            </div>
        `;
    });

    foodListContainer.innerHTML = htmlFood; /* Inserisce l'HTML generato nella pagina */

    // ===========================================
    // 5. LOGICA GRAFICO BUDGET (CHART.JS)
    // ===========================================

    const categories = budgetData.map(item => item.categoria.split('(')[0].trim()); /* Estrae le etichette delle categorie, pulendole */
    const costs = budgetData.map(item => item.costo); /* Estrae i valori dei costi */
    
    const totalCost = costs.reduce((sum, cost) => sum + cost, 0); /* Usa reduce() per sommare tutti i costi in un unico totale */

    // Aggiorna il placeholder del budget totale nell'introduzione
    document.getElementById('total-budget-placeholder').textContent = `‚Ç¨ ${totalCost.toFixed(2)}`; /* Aggiorna il valore totale nell'introduzione (es. "‚Ç¨ 338.20") */

    // Colori a tema imperiale/bordeaux per il grafico (compatibili con Chart.js)
    const imperialColors = [
        '#8C0000', '#C8AA50', '#A52A2A', '#D4AF37', '#B22222', '#696969', '#E6C3A3'
    ];

    const ctx = document.getElementById('budgetChart').getContext('2d'); /* Ottiene il contesto di disegno 2D del canvas */
    
    const budgetChart = new Chart(ctx, { /* Crea un nuovo grafico Chart.js */
        type: 'pie', /* Tipo di grafico: a torta */
        data: {
            labels: categories, /* I nomi delle categorie per gli spicchi */
            datasets: [{
                data: costs, /* I valori numerici che determinano la dimensione degli spicchi */
                backgroundColor: imperialColors, /* I colori da usare */
                borderColor: 'white',
                borderWidth: 2,
                hoverOffset: 8
            }]
        },
        options: {
            responsive: true, /* Adatta la dimensione del grafico allo schermo */
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    position: 'right', /* Legenda a destra */
                    labels: { font: { family: 'Georgia, serif', size: 12 }, }
                },
                title: {
                    display: true,
                    text: `Ripartizione Costi per Persona (Totale: ‚Ç¨ ${totalCost.toFixed(2)})`,
                    font: { size: 18, family: 'Georgia, serif' },
                    color: getComputedStyle(document.documentElement).getPropertyValue('--color-primary')
                },
                tooltip: { /* Personalizzazione del box informativo che appare al passaggio del mouse */
                    callbacks: {
                        label: function(context) {
                            let label = context.label || '';
                            if (label) { label += ': '; }
                            label += new Intl.NumberFormat('it-IT', { style: 'currency', currency: 'EUR' }).format(context.raw); /* Formatta il valore come valuta (‚Ç¨) */
                            return label;
                        }
                    }
                }
            }
        }
    });

</script>
</body>
</html>

